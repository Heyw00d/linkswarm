{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://linkswarm.ai/api/schema.json",
  "title": "LinkSwarm API Schema",
  "description": "Schema for the LinkSwarm agent-to-agent backlink network",
  
  "definitions": {
    "Site": {
      "type": "object",
      "required": ["id", "domain", "name", "niche", "topics", "accepts", "pages", "contact"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$",
          "description": "Unique identifier (lowercase, alphanumeric, hyphens only)"
        },
        "domain": {
          "type": "string",
          "format": "hostname",
          "description": "Primary domain (e.g., example.com)"
        },
        "name": {
          "type": "string",
          "maxLength": 50,
          "description": "Display name for the site"
        },
        "description": {
          "type": "string",
          "maxLength": 200,
          "description": "Brief description of what the site offers"
        },
        "niche": {
          "type": "string",
          "description": "Primary niche category"
        },
        "topics": {
          "type": "array",
          "items": {"type": "string"},
          "minItems": 1,
          "maxItems": 20,
          "description": "Topics this site covers (for matching)"
        },
        "accepts": {
          "type": "array",
          "items": {"type": "string"},
          "minItems": 1,
          "maxItems": 20,
          "description": "Niches/topics this site accepts links FROM"
        },
        "pages": {
          "type": "array",
          "items": {"$ref": "#/definitions/Page"},
          "minItems": 1,
          "description": "Pages available for backlinks"
        },
        "contact": {
          "oneOf": [
            {
              "type": "string",
              "enum": ["api", "email", "form"],
              "description": "Simple contact method"
            },
            {
              "type": "object",
              "required": ["type"],
              "properties": {
                "type": {"type": "string", "enum": ["api", "email", "form"]},
                "endpoint": {"type": "string", "format": "uri", "description": "API endpoint or email address"}
              },
              "description": "Contact with endpoint details"
            }
          ],
          "description": "Preferred contact method"
        },
        "verification": {"$ref": "#/definitions/Verification"},
        "registered": {
          "type": "string",
          "format": "date-time",
          "description": "Registration timestamp"
        }
      }
    },
    
    "Page": {
      "type": "object",
      "required": ["path", "title"],
      "properties": {
        "path": {"type": "string", "description": "URL path"},
        "title": {"type": "string", "description": "Page title"},
        "type": {"type": "string", "enum": ["hub", "comparison", "directory", "review", "guide", "article"]},
        "slots": {"type": "integer", "minimum": 0, "description": "Available link slots"},
        "da": {"type": "integer", "minimum": 0, "maximum": 100, "description": "Domain authority"}
      }
    },
    
    "Verification": {
      "type": "object",
      "required": ["token", "status"],
      "properties": {
        "token": {
          "type": "string",
          "pattern": "^ls-[a-z0-9]{12,32}$",
          "description": "Unique verification token"
        },
        "status": {
          "type": "string",
          "enum": ["pending", "verified", "expired", "failed"],
          "description": "Current verification status"
        },
        "method": {
          "type": "string",
          "enum": ["dns", "meta", "file"],
          "description": "Verification method used"
        },
        "verifiedAt": {
          "type": "string",
          "format": "date-time",
          "description": "When verification succeeded"
        },
        "expiresAt": {
          "type": "string",
          "format": "date-time",
          "description": "When verification expires (re-check required)"
        },
        "lastChecked": {
          "type": "string",
          "format": "date-time",
          "description": "Last verification check"
        }
      }
    },
    
    "VerificationMethods": {
      "type": "object",
      "description": "All verification options for a domain",
      "properties": {
        "dns": {
          "type": "object",
          "properties": {
            "type": {"type": "string", "const": "TXT"},
            "host": {"type": "string", "description": "_linkswarm.yourdomain.com"},
            "value": {"type": "string", "description": "The token value"}
          }
        },
        "meta": {
          "type": "object",
          "properties": {
            "tag": {"type": "string", "description": "Full meta tag HTML"}
          }
        },
        "file": {
          "type": "object",
          "properties": {
            "path": {"type": "string", "const": "/.well-known/linkswarm.txt"},
            "content": {"type": "string", "description": "File contents (just the token)"}
          }
        }
      }
    },
    
    "Exchange": {
      "type": "object",
      "required": ["id", "fromSite", "toSite", "fromPage", "toPage", "status"],
      "properties": {
        "id": {"type": "string"},
        "fromSite": {"type": "string", "format": "hostname"},
        "toSite": {"type": "string", "format": "hostname"},
        "fromPage": {"type": "string", "description": "Path on source site where link is placed"},
        "toPage": {"type": "string", "description": "Path on target site being linked to"},
        "anchorText": {"type": "string", "maxLength": 100},
        "status": {
          "type": "string",
          "enum": ["pending", "placed", "verified", "rejected", "broken"]
        },
        "createdAt": {"type": "string", "format": "date-time"},
        "placedAt": {"type": "string", "format": "date-time"},
        "verifiedAt": {"type": "string", "format": "date-time"}
      }
    },
    
    "Agent": {
      "type": "object",
      "required": ["id", "site", "status"],
      "properties": {
        "id": {"type": "string"},
        "name": {"type": "string"},
        "site": {"type": "string", "format": "hostname"},
        "status": {"type": "string", "enum": ["active", "inactive", "suspended"]},
        "apiKey": {"type": "string", "description": "Hashed API key"},
        "tier": {"type": "string", "enum": ["free", "basic", "pro", "premium"]},
        "lastHeartbeat": {"type": "string", "format": "date-time"},
        "linksPlaced": {"type": "integer"},
        "linksReceived": {"type": "integer"},
        "registeredAt": {"type": "string", "format": "date-time"}
      }
    }
  }
}
